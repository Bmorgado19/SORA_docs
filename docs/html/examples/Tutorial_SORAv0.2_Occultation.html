

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Occultation Class &mdash; Stellar Occultation Reduction Analysis 0.2 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ChiSquare Class" href="Tutorial_SORAv0.2_ChiSquare.html" />
    <link rel="prev" title="LightCurve Class" href="Tutorial_SORAv0.2_LightCurve.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Stellar Occultation Reduction Analysis
          

          
          </a>

          
            
            
              <div class="version">
                v0.2-alpha
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Details:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">SORA Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">Using and Citing SORA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../team.html">About Us</a></li>
</ul>
<p class="caption"><span class="caption-text">Code:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../sora.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_SORAv0.2_GettingStarted.html">SORA Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../jupyters.html">Jupyter-Notebook Guidelines</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Tutorial_SORAv0.2_Body.html">Body Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial_SORAv0.2_Star.html">Star Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial_SORAv0.2_Prediction.html">Prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial_SORAv0.2_Observer.html">Observer Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial_SORAv0.2_LightCurve.html">LightCurve Class</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Occultation Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#0.-Index">0. Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="#1.-Instantiating-the-Occultation-Object-and-adding-observations">1. Instantiating the Occultation Object and adding observations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.-Projecting-the-times-in-the-sky-plane-and-the-Chords">2. Projecting the times in the sky plane and the Chords</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.-Ellipse-fit">3. Ellipse fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#4.-Viewing-and-saving-the-results">4. Viewing and saving the results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial_SORAv0.2_ChiSquare.html">ChiSquare Class</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Stellar Occultation Reduction Analysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../jupyters.html">Jupyter-Notebook Guidelines</a> &raquo;</li>
        
      <li>Occultation Class</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/examples/Tutorial_SORAv0.2_Occultation.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Occultation-Class">
<h1>Occultation Class<a class="headerlink" href="#Occultation-Class" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">Occultation</span></code> Object Class within SORA was created to reduce and analyze stellar occultations, and control all the other Object Classes at SORA package. Here we have some useful tasks that allow converting the times for each observatory in positions in the sky plane (<span class="math notranslate nohighlight">\(\xi\)</span>, <span class="math notranslate nohighlight">\(\eta\)</span>), fit an ellipse to the points, obtain the astrometrical position resulting, among others.</p>
<p>The documentation here contains the details about every step.</p>
<p>This Jupyter-Notebook was designed as a tutorial for how to work with the <code class="docutils literal notranslate"><span class="pre">Occultation</span></code> Object Class. More information about the other classes, please refer to their specif Jupyter-Notebook. Any further question, please contact the core team: Altair Ramos Gomes Júnior, Bruno Eduardo Morgado, Gustavo Benedetti Rossi, and Rodrigo Carlos Boufleur.</p>
<p><strong>The</strong> <code class="docutils literal notranslate"><span class="pre">Occultation</span></code> <strong>Docstring was designed to help the users. Also, each function has its Docstring containing its main purpose and the needed parameters (physical description and formats). Please, do not hesitate to use it.</strong></p>
<div class="section" id="0.-Index">
<h2>0. Index<a class="headerlink" href="#0.-Index" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p><a class="reference external" href="#section_1">Instantiating the Occultation Object and adding observations</a></p></li>
<li><p><a class="reference external" href="#section_2">Projecting the times in the sky plane and the Chords</a></p></li>
<li><p><a class="reference external" href="#section_3">Ellipse fit</a></p></li>
<li><p><a class="reference external" href="#section_4">Viewing and saving the results</a></p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## SORA package</span>
<span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">Occultation</span><span class="p">,</span> <span class="n">Body</span><span class="p">,</span> <span class="n">Star</span><span class="p">,</span> <span class="n">LightCurve</span><span class="p">,</span> <span class="n">Observer</span>

<span class="c1">## Other main packages</span>
<span class="c1">#from astropy.time import Time</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>

<span class="c1">## Usual packages</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="1.-Instantiating-the-Occultation-Object-and-adding-observations">
<h2>1. Instantiating the Occultation Object and adding observations<a class="headerlink" href="#1.-Instantiating-the-Occultation-Object-and-adding-observations" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Occultation</span></code> Object Class can be instantiated in only one way. For this it is needed a <code class="docutils literal notranslate"><span class="pre">Star</span></code> Object, an <code class="docutils literal notranslate"><span class="pre">Body</span></code> Object with a <code class="docutils literal notranslate"><span class="pre">Ephemeris</span></code> Object (<code class="docutils literal notranslate"><span class="pre">EphemKernel</span></code>, <code class="docutils literal notranslate"><span class="pre">EphemPlanet</span></code> or <code class="docutils literal notranslate"><span class="pre">EphemHorizons</span></code>), and the occultation time (within 60 minutes of the correct value).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>Occultation<span class="o">?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">Init signature:</span> Occultation<span class="ansi-blue-fg">(</span>star<span class="ansi-blue-fg">,</span> body<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> ephem<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> time<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>
Does the reduction of the occultation

<span class="ansi-red-fg">Init docstring:</span>
Instantiates the Occultation object.

Parameters:
    star (Star, str): The coordinate of the star in the same reference frame as the ephemeris.
        It must be a Star object or a string with the coordinates of the object to search on
        Vizier (required).
    body* (Body, str): Object that will occult the star. It must be a Body object or its
        name to search in the Small Body Database.
    ephem* (Ephem): object ephemeris. It must be an Ephemeris object or a list .
    time (str, Time): Reference time of the occultation.
        Time does not need to be exact, but needs to be within approximately 50 minutes
        of the occultation closest approach to calculate occultation parameters (required).

* When instantiating with &#34;body&#34; and &#34;ephem&#34;, the user may define the Occultation in 3 ways:
    - With &#34;body&#34; and &#34;ephem&#34;.
    - With only &#34;body&#34;. In this case, the &#34;body&#34; parameter must be a Body object and have an
        ephemeris associated (see Body documentation).
    - With only &#34;ephem&#34;. In this case, the &#34;ephem&#34; parameter must be one of the Ephem Classes
        and have a name (see Ephem documentation) to search for the body in the Small Body Database.
<span class="ansi-red-fg">File:</span>           ~/anaconda3/lib/python3.8/site-packages/sora/occultation/core.py
<span class="ansi-red-fg">Type:</span>           type
<span class="ansi-red-fg">Subclasses:</span>

</pre></div></div>
</div>
<p><strong>First let’s instanciate the</strong> <code class="docutils literal notranslate"><span class="pre">Star</span></code> <strong>and the</strong> <code class="docutils literal notranslate"><span class="pre">Body</span></code></p>
<p>SORA will automatically search for the star information. A warning will raise when any information is missing. In this example, there is no star radius available in Gaia.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chariklo</span> <span class="o">=</span> <span class="n">Body</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Chariklo&#39;</span><span class="p">,</span>
                <span class="n">ephem</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;input/bsp/Chariklo.bsp&#39;</span><span class="p">,</span> <span class="s1">&#39;input/bsp/de438_small.bsp&#39;</span><span class="p">])</span>

<span class="n">star_occ</span>  <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">coord</span><span class="o">=</span><span class="s1">&#39;18 55 15.65250 -31 31 21.67051&#39;</span><span class="p">)</span> <span class="c1"># Occ Chariklo 22-06-2017</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Obtaining data for Chariklo from SBDB

Downloading star parameters from I/350/gaiaedr3
1 Gaia-EDR3 star found G=14.223702
star coordinate at J2016.0: RA=18h55m15.65210s +/- 0.0197 mas, DEC=-31d31m21.6676s +/- 0.018 mas

Downloading star parameters from I/297/out
</pre></div></div>
</div>
<p><strong>Now, we can instantiate the Occultation</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span> <span class="o">=</span> <span class="n">Occultation</span><span class="p">(</span><span class="n">star</span><span class="o">=</span><span class="n">star_occ</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">chariklo</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:18&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">occ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Stellar occultation of star Gaia-DR2 6760223758801661440 by 10199 Chariklo (1997 CU26).

Geocentric Closest Approach: 0.049 arcsec
Instant of CA: 2017-06-22 21:18:48.200
Position Angle: 359.72 deg
Geocentric shadow velocity: -22.00 km / s
Sun-Geocenter-Target angle:  166.42 deg
Moon-Geocenter-Target angle: 149.11 deg


No observations reported

###############################################################################
                                     STAR
###############################################################################
Gaia-EDR3 star Source ID: 6760223758801661440
ICRS star coordinate at J2016.0:
RA=18h55m15.65210s +/- 0.0197 mas, DEC=-31d31m21.6676s +/- 0.0180 mas
pmRA=3.556 +/- 0.025 mas/yr, pmDEC=-2.050 +/- 0.020 mas/yr
Plx=0.2121 +/- 0.0228 mas, Rad. Vel.=0.00 +/- 0.00 km/s

Magnitudes: G: 14.224, B: 14.320, V: 13.530, R: 14.180, J: 12.395, H: 11.781,
            K: 11.627

Apparent diameter from Kervella et. al (2004):
    V: 0.0216 mas, B: 0.0216 mas
Apparent diameter from van Belle (1999):
    sg: B: 0.0238 mas, V: 0.0244 mas
    ms: B: 0.0261 mas, V: 0.0198 mas
    vs: B: 0.0350 mas, V: 0.0315 mas

Geocentric star coordinate at occultation Epoch (2017-06-22 21:18:48.200):
RA=18h55m15.65251s +/- 0.0395 mas, DEC=-31d31m21.6706s +/- 0.0300 mas

###############################################################################
                          10199 Chariklo (1997 CU26)
###############################################################################
Object Orbital Class: Centaur
Spectral Type:
    SMASS: D  [Reference: EAR-A-5-DDR-TAXONOMY-V4.0]
       Relatively featureless spectrum with very steep red slope.
Discovered 1997-Feb-15 by Spacewatch at Kitt Peak

Physical parameters:
Diameter:
    302 +/- 30 km
    Reference: Earth, Moon, and Planets, v. 89, Issue 1, p. 117-134 (2002),
Rotation:
    7.004 +/- 0 h
    Reference: LCDB (Rev. 2020-October); Warner et al., 2009, [Result based on less than full coverage, so that the period may be wrong by 30 percent or so.]  REFERENCE LIST:[Fornasier, S.; Lazzaro, D.; Alvarez-Candal, A.; Snodgrass, C.; et   al. (2014) Astron. Astrophys. 568, L11.], [Leiva, R.; Sicardy, B.; Camargo, J.I.B.; Desmars, J.; et al. (2017)   Astron. J. 154, A159.]
Absolute Magnitude:
    6.7 +/- 0 mag
    Reference: MPO452314,
Albedo:
    0.045 +/- 0.01
    Reference: Earth, Moon, and Planets, v. 89, Issue 1, p. 117-134 (2002),

----------- Ephemeris -----------

EphemKernel: CHARIKLO/DE438_SMALL (SPKID=2010199)
Ephem Error: RA*cosDEC: 0.000 arcsec; DEC: 0.000 arcsec
Offset applied: RA*cosDEC: 0.0000 arcsec; DEC: 0.0000 arcsec



</pre></div></div>
</div>
<p><strong>Note that at the</strong> <code class="docutils literal notranslate"><span class="pre">print(Occultation)</span></code> <strong>there are no observations added to this</strong> <code class="docutils literal notranslate"><span class="pre">Occultation</span></code> <strong>yet.</strong></p>
<p>It is needed one <code class="docutils literal notranslate"><span class="pre">Observer</span></code> and one <code class="docutils literal notranslate"><span class="pre">LightCurve</span></code> to define an <code class="docutils literal notranslate"><span class="pre">Chord</span></code>.</p>
<p><strong>Let’s instanciate the</strong> <code class="docutils literal notranslate"><span class="pre">Observers</span></code></p>
<p>Here we will give 5 locations</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">out</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Outeniqua&#39;</span>  <span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="s1">&#39;+16 49 17.710&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;-21 17 58.170&#39;</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span><span class="mi">1416</span><span class="p">)</span>
<span class="n">ond</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Onduruquea&#39;</span> <span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="s1">&#39;+15 59 33.750&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;-21 36 26.040&#39;</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span><span class="mi">1220</span><span class="p">)</span>
<span class="n">tiv</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Tivoli&#39;</span>     <span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="s1">&#39;+18 01 01.240&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;-23 27 40.190&#39;</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span><span class="mi">1344</span><span class="p">)</span>
<span class="n">whc</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Windhoek&#39;</span>   <span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="s1">&#39;+17 06 31.900&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;-22 41 55.160&#39;</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span><span class="mi">1902</span><span class="p">)</span>
<span class="n">hak</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Hakos&#39;</span>      <span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="s1">&#39;+16 21 41.320&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;-23 14 11.040&#39;</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span><span class="mi">1843</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>Let’s instanciate the</strong> <code class="docutils literal notranslate"><span class="pre">LightCurves</span></code></p>
<p>Here we give 6 light curves. Note that 2 are for the same site observed with different telescopes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#INCREASE THE ERRORS!!!!</span>

<span class="n">out_lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Outeniqua lc&#39;</span><span class="p">,</span>
                    <span class="n">initial_time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:20:00.056&#39;</span><span class="p">,</span>
                    <span class="n">end_time</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:29:59.963&#39;</span><span class="p">,</span>
                    <span class="n">immersion</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:20.329&#39;</span><span class="p">,</span><span class="n">immersion_err</span><span class="o">=</span><span class="mf">0.320</span><span class="p">,</span>
                    <span class="n">emersion</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:30.343&#39;</span><span class="p">,</span><span class="n">emersion_err</span><span class="o">=</span><span class="mf">0.340</span><span class="p">)</span>

<span class="n">ond_lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Onduruquea lc&#39;</span><span class="p">,</span>
                    <span class="n">initial_time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:11:52.175&#39;</span><span class="p">,</span>
                    <span class="n">end_time</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:25:13.389&#39;</span><span class="p">,</span>
                    <span class="n">immersion</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:22.213&#39;</span><span class="p">,</span><span class="n">immersion_err</span><span class="o">=</span><span class="mf">0.100</span><span class="p">,</span>
                    <span class="n">emersion</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:33.824&#39;</span><span class="p">,</span><span class="n">emersion_err</span><span class="o">=</span><span class="mf">0.110</span><span class="p">)</span>

<span class="n">tiv_lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Tivoli lc&#39;</span><span class="p">,</span>
                    <span class="n">initial_time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:16:00.094&#39;</span><span class="p">,</span>
                    <span class="n">end_time</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:28:00.018&#39;</span><span class="p">,</span>
                    <span class="n">immersion</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:15.628&#39;</span><span class="p">,</span><span class="n">immersion_err</span><span class="o">=</span><span class="mf">0.700</span><span class="p">,</span>
                    <span class="n">emersion</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:19.988&#39;</span><span class="p">,</span><span class="n">emersion_err</span><span class="o">=</span><span class="mf">0.700</span><span class="p">)</span>

<span class="n">whc_c14_lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Windhoek C14 lc&#39;</span><span class="p">,</span>
                    <span class="n">initial_time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:12:48.250&#39;</span><span class="p">,</span>
                    <span class="n">end_time</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:32:47.963&#39;</span><span class="p">,</span>
                    <span class="n">immersion</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:17.609&#39;</span><span class="p">,</span><span class="n">immersion_err</span><span class="o">=</span><span class="mf">0.240</span><span class="p">,</span>
                    <span class="n">emersion</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:27.564&#39;</span><span class="p">,</span><span class="n">emersion_err</span><span class="o">=</span><span class="mf">0.260</span><span class="p">)</span>

<span class="n">whc_d16_lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Windhoek D16 lc&#39;</span><span class="p">,</span>
                    <span class="n">initial_time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:20:01.884&#39;</span><span class="p">,</span>
                    <span class="n">end_time</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:22:21.894&#39;</span><span class="p">,</span>
                    <span class="n">immersion</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:17.288&#39;</span><span class="p">,</span><span class="n">immersion_err</span><span class="o">=</span><span class="mf">0.280</span><span class="p">,</span>
                    <span class="n">emersion</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:27.228&#39;</span><span class="p">,</span><span class="n">emersion_err</span><span class="o">=</span><span class="mf">0.340</span><span class="p">)</span>

<span class="n">hak_lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Hakos lc&#39;</span><span class="p">,</span>
                    <span class="n">initial_time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:10:19.461&#39;</span><span class="p">,</span>
                    <span class="n">end_time</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:30:19.345&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>To add the observation to the</strong> <code class="docutils literal notranslate"><span class="pre">Occultation</span></code> <strong>just use the</strong> <code class="docutils literal notranslate"><span class="pre">Occultation.chords.add_chord()</span></code></p>
<p>During this step the <code class="docutils literal notranslate"><span class="pre">LightCurve</span></code> is automatic updated using the <code class="docutils literal notranslate"><span class="pre">Occultation</span></code> parameters: the Shadow’s velocity, the star diameter and the distance to the occulting body. This means that is no need for the user to do the <code class="docutils literal notranslate"><span class="pre">LightCurve.set_dist()</span></code>, <code class="docutils literal notranslate"><span class="pre">LightCurve.set_vel()</span></code> and <code class="docutils literal notranslate"><span class="pre">LightCurve.set_star_diam()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">observer</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">lightcurve</span><span class="o">=</span><span class="n">out_lc</span><span class="p">)</span>
<span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">observer</span><span class="o">=</span><span class="n">ond</span><span class="p">,</span> <span class="n">lightcurve</span><span class="o">=</span><span class="n">ond_lc</span><span class="p">)</span>
<span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">observer</span><span class="o">=</span><span class="n">tiv</span><span class="p">,</span> <span class="n">lightcurve</span><span class="o">=</span><span class="n">tiv_lc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/morgado/anaconda3/lib/python3.8/site-packages/sora/body/core.py:228: UserWarning: H and/or G is not defined for 10199 Chariklo. Searching into JPL Horizons service
  warnings.warn(&#39;H and/or G is not defined for {}. Searching into JPL Horizons service&#39;.format(self.shortname))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Chord: Tivoli&gt;
</pre></div></div>
</div>
<p>Note that a warning comes up if the flux drop is not calculated automatically.</p>
<p><strong>The same goes for two observation at with the same</strong> <code class="docutils literal notranslate"><span class="pre">Observer</span></code> <strong>, however is important to define their names as different values</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Windhoek C14 lc&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="n">whc</span><span class="p">,</span> <span class="n">lightcurve</span><span class="o">=</span><span class="n">whc_c14_lc</span><span class="p">)</span>
<span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Windhoek D16 lc&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="n">whc</span><span class="p">,</span> <span class="n">lightcurve</span><span class="o">=</span><span class="n">whc_d16_lc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Chord: Windhoek D16 lc&gt;
</pre></div></div>
</div>
<p><strong>Also, the same goes for negative observations</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">observer</span><span class="o">=</span><span class="n">hak</span><span class="p">,</span> <span class="n">lightcurve</span><span class="o">=</span><span class="n">hak_lc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Chord: Hakos&gt;
</pre></div></div>
</div>
<p><strong>To check which observers were added to the</strong> <code class="docutils literal notranslate"><span class="pre">Occultation</span></code> <strong>just use</strong> <code class="docutils literal notranslate"><span class="pre">Occultation.chords</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chords</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;ChordList:
    0: Chord(Outeniqua)
    1: Chord(Onduruquea)
    2: Chord(Tivoli)
    3: Chord(Windhoek C14 lc)
    4: Chord(Windhoek D16 lc)
    5: Chord(Hakos)&gt;
</pre></div></div>
</div>
<p><strong>If any of them was wrongly added just remove it using</strong> <code class="docutils literal notranslate"><span class="pre">Occultation.chords.remove_chord()</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">remove_chord</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Outeniqua&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chords</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;ChordList:
    0: Chord(Onduruquea)
    1: Chord(Tivoli)
    2: Chord(Windhoek C14 lc)
    3: Chord(Windhoek D16 lc)
    4: Chord(Hakos)&gt;
</pre></div></div>
</div>
<p><strong>If all the chords were wrongly added the user can clear the</strong> <code class="docutils literal notranslate"><span class="pre">Occultation</span></code> <strong>using</strong> <code class="docutils literal notranslate"><span class="pre">Occultation.chords.clear()</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chords</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;ChordList:&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">observer</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">lightcurve</span><span class="o">=</span><span class="n">out_lc</span><span class="p">)</span>
<span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">observer</span><span class="o">=</span><span class="n">ond</span><span class="p">,</span> <span class="n">lightcurve</span><span class="o">=</span><span class="n">ond_lc</span><span class="p">)</span>
<span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">observer</span><span class="o">=</span><span class="n">tiv</span><span class="p">,</span> <span class="n">lightcurve</span><span class="o">=</span><span class="n">tiv_lc</span><span class="p">)</span>
<span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Windhoek C14 lc&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="n">whc</span><span class="p">,</span> <span class="n">lightcurve</span><span class="o">=</span><span class="n">whc_c14_lc</span><span class="p">)</span>
<span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Windhoek D16 lc&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="n">whc</span><span class="p">,</span> <span class="n">lightcurve</span><span class="o">=</span><span class="n">whc_d16_lc</span><span class="p">)</span>
<span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">observer</span><span class="o">=</span><span class="n">hak</span><span class="p">,</span> <span class="n">lightcurve</span><span class="o">=</span><span class="n">hak_lc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/morgado/anaconda3/lib/python3.8/site-packages/sora/body/core.py:228: UserWarning: H and/or G is not defined for 10199 Chariklo. Searching into JPL Horizons service
  warnings.warn(&#39;H and/or G is not defined for {}. Searching into JPL Horizons service&#39;.format(self.shortname))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Chord: Hakos&gt;
</pre></div></div>
</div>
</div>
<div class="section" id="2.-Projecting-the-times-in-the-sky-plane-and-the-Chords">
<h2>2. Projecting the times in the sky plane and the Chords<a class="headerlink" href="#2.-Projecting-the-times-in-the-sky-plane-and-the-Chords" title="Permalink to this headline">¶</a></h2>
<p>This step is done automatically without the user has to ask for it. The user can see its automatically using <code class="docutils literal notranslate"><span class="pre">Occultation.chords.summary()</span></code> that contains all positions for all observations added.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
      Name       Longitude      Latitude      status              time              f        g
--------------- ------------ ------------- ------------ ----------------------- --------- -------
      Outeniqua 16d49m17.71s -21d17m58.17s Initial Time 2017-06-22 21:20:00.056  -1912.81   45.76
                                              Immersion 2017-06-22 21:21:20.329   -118.27   65.39
                                               Emersion 2017-06-22 21:21:30.343    105.61   67.83
                                               End Time 2017-06-22 21:29:59.963  11501.41  190.23
     Onduruquea 15d59m33.75s -21d36m26.04s Initial Time 2017-06-22 21:11:52.175 -12876.38 -135.47
                                              Immersion 2017-06-22 21:21:22.213   -138.24    7.19
                                               Emersion 2017-06-22 21:21:33.824    121.28   10.05
                                               End Time 2017-06-22 21:25:13.389   5029.50   63.76
         Tivoli 18d01m01.24s -23d27m40.19s Initial Time 2017-06-22 21:16:00.094  -7123.65 -202.64
                                              Immersion 2017-06-22 21:21:15.628    -70.55 -126.77
                                               Emersion 2017-06-22 21:21:19.988     26.92 -125.73
                                               End Time 2017-06-22 21:28:00.018   8971.46  -31.61
Windhoek C14 lc  17d06m31.9s -22d41m55.16s Initial Time 2017-06-22 21:12:48.250 -11505.41 -198.50
                                              Immersion 2017-06-22 21:21:17.609   -121.71  -73.52
                                               Emersion 2017-06-22 21:21:27.564    100.83  -71.11
                                               End Time 2017-06-22 21:32:47.963  15314.99   90.02
Windhoek D16 lc  17d06m31.9s -22d41m55.16s Initial Time 2017-06-22 21:20:01.884  -1814.41  -91.87
                                              Immersion 2017-06-22 21:21:17.288   -128.88  -73.60
                                               Emersion 2017-06-22 21:21:27.228     93.32  -71.19
                                               End Time 2017-06-22 21:22:21.894   1315.36  -58.00
          Hakos 16d21m41.32s -23d14m11.04s Initial Time 2017-06-22 21:10:19.461 -14875.33 -316.83
                                               End Time 2017-06-22 21:30:19.345  11939.87  -23.53
</pre></div></div>
</div>
<p><strong>Let’s give a look to an specific</strong> <code class="docutils literal notranslate"><span class="pre">Chord</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chord</span> <span class="o">=</span> <span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="p">[</span><span class="s1">&#39;Outeniqua&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p><strong>The user can easilly acess the f and g for the immersion and emersion times using the</strong> <code class="docutils literal notranslate"><span class="pre">Chord.get_fg()</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chord</span><span class="o">.</span><span class="n">get_fg</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([-118.26992111,  105.60676935]), array([65.39061267, 67.83300259]))
</pre></div></div>
</div>
<p><strong>The user can also set a specific time</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chord</span><span class="o">.</span><span class="n">get_fg</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:00:00.000&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-28724.975705022654, -258.35849230382314)
</pre></div></div>
</div>
<p><strong>Finally, the user can visually see the chord in the Sky-plane using the</strong> <code class="docutils literal notranslate"><span class="pre">Chord.plot_chord()</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chord</span><span class="o">.</span><span class="n">plot_chord</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">chord</span><span class="o">.</span><span class="n">plot_chord</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">+</span><span class="mi">250</span><span class="p">,</span><span class="o">-</span><span class="mi">250</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span><span class="o">+</span><span class="mi">250</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Tutorial_SORAv0.2_Occultation_38_0.png" src="../_images/examples_Tutorial_SORAv0.2_Occultation_38_0.png" />
</div>
</div>
<p><strong>Let’s define an</strong> <code class="docutils literal notranslate"><span class="pre">LightCurve</span></code> <strong>with times and fluxes</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chord2</span> <span class="o">=</span> <span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="p">[</span><span class="s1">&#39;Hakos&#39;</span><span class="p">]</span>

<span class="n">chord2</span><span class="o">.</span><span class="n">lightcurve</span><span class="o">.</span><span class="n">set_flux</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;input/lightcurves/lc_example_5.dat&#39;</span><span class="p">,</span> <span class="n">exptime</span><span class="o">=</span><span class="mf">1.000</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p><strong>The</strong> <code class="docutils literal notranslate"><span class="pre">Chord.plot_chord()</span></code> <strong>can also be used with an</strong> <code class="docutils literal notranslate"><span class="pre">linestyle</span> <span class="pre">=</span> <span class="pre">exposure</span></code> <strong>to see the times where the the chord in fact holds information and the readout time (without information).</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chord2</span><span class="o">.</span><span class="n">plot_chord</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;exposure&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">+</span><span class="mi">250</span><span class="p">,</span><span class="o">-</span><span class="mi">250</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span><span class="o">+</span><span class="mi">250</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Tutorial_SORAv0.2_Occultation_42_0.png" src="../_images/examples_Tutorial_SORAv0.2_Occultation_42_0.png" />
</div>
</div>
<p><strong>Now let’s consider all the chords</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">()</span>
<span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">+</span><span class="mi">170</span><span class="p">,</span><span class="o">-</span><span class="mi">330</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span><span class="o">+</span><span class="mi">250</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Tutorial_SORAv0.2_Occultation_44_0.png" src="../_images/examples_Tutorial_SORAv0.2_Occultation_44_0.png" />
</div>
</div>
<p><strong>If there are know time shifts, this can be easily solved using</strong> <code class="docutils literal notranslate"><span class="pre">LightCurve.dt</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">out_lc</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.150</span>
<span class="n">ond_lc</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.190</span>
<span class="n">tiv_lc</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.150</span>
<span class="n">whc_c14_lc</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.375</span>
<span class="n">whc_d16_lc</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="o">+</span><span class="mf">0.000</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">()</span>
<span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">+</span><span class="mi">170</span><span class="p">,</span><span class="o">-</span><span class="mi">330</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span><span class="o">+</span><span class="mi">250</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Tutorial_SORAv0.2_Occultation_47_0.png" src="../_images/examples_Tutorial_SORAv0.2_Occultation_47_0.png" />
</div>
</div>
<p><strong>The user can save these position</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">to_file</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="3.-Ellipse-fit">
<h2>3. Ellipse fit<a class="headerlink" href="#3.-Ellipse-fit" title="Permalink to this headline">¶</a></h2>
<p>The next step is the fitting of an ellipse. The five parameters that describe the ellipse are:</p>
<p><strong>1.</strong> and <strong>2.</strong> The centre position (<span class="math notranslate nohighlight">\(f_0\)</span>, <span class="math notranslate nohighlight">\(g_0\)</span>)</p>
<p><strong>3.</strong> The apparent equatorial radius, semi-major axix (<span class="math notranslate nohighlight">\(a'\)</span>)</p>
<p><strong>4.</strong> The oblatness (<span class="math notranslate nohighlight">\(\epsilon' = \frac{a' - b'}{a'}\)</span>)</p>
<p><strong>5.</strong> The position angle of the pole, semi-minor axix (<span class="math notranslate nohighlight">\(P\)</span>)</p>
<p>The result of the fit is a <code class="docutils literal notranslate"><span class="pre">ChiSquare</span></code> Object, and its functions can be found at its specific Jupyter-Notebook.</p>
<p><strong>Here, there is only the manual method, the user should provide the parameters to the fit and also the region for searching each parameters.</strong></p>
<p>The equation to be minimize is:</p>
<p><span class="math notranslate nohighlight">\(\chi^2 = \sum_{i}^{N} \frac{(r_{i} - r'_{i})^2}{\sigma_i^2 + \sigma_{model}^2}\)</span></p>
<p>where: - <span class="math notranslate nohighlight">\(r_i\)</span> is the radial distance between the <span class="math notranslate nohighlight">\(i^{th}\)</span> observed point and the ellipse centre; - <span class="math notranslate nohighlight">\(r'_i\)</span> is the radial distance between the modelled ellipse’s <span class="math notranslate nohighlight">\(i^{th}\)</span> point and the ellipse centre; - <span class="math notranslate nohighlight">\(\sigma_i\)</span> is the unceartainty of the <span class="math notranslate nohighlight">\(i^{th}\)</span> observed point - <span class="math notranslate nohighlight">\(\sigma_{model}\)</span> is the model unceartainty, that is releated to the difference between the real apparent shape of the occultating object and the ellipse model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>occ.fit_ellipse<span class="o">?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">Signature:</span> occ<span class="ansi-blue-fg">.</span>fit_ellipse<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>
Fits an ellipse to given occultation using given parameters

Parameters:
    required params:
    Each occultation is added as the first arguments directly.
        center_f (int,float): The coordinate in f of the ellipse center. Default=0
        center_g (int,float): The coordinate in g of the ellipse center. Default=0
        equatorial_radius (int,float): The Equatorial radius (semi-major axis) of the ellipse.
        oblateness (int,float): The oblateness of the ellipse. Default=0 (circle)
        position_angle (int,float): The pole position angle of the ellipse in degrees. Default=0
            Zero is in the North direction (&#39;g-positive&#39;). Positive clockwise.

    Parameters interval of fitting. Default values are set to zero.
    Search between (value - dvalue) and (value + dvalue):
        dcenter_f (int,float): Interval for coordinate f of the ellipse center
        dcenter_g (int,float): Interval for coordinate g of the ellipse center
        dequatorial_radius (int,float): Interval for the Equatorial radius (semi-major axis) of the ellipse
        doblateness (int,float): Interval for the oblateness of the ellipse
        dposition_angle (int,float): Interval for the pole position angle of the ellipse in degrees

    loop (int): The number of ellipses to attempt fitting. Default: 10,000,000
    dchi_min (intt,float): If given, it will only save ellipsis which chi square are
        smaller than chi_min + dchi_min.
    number_chi (int): if dchi_min is given, the procedure is repeated until
        number_chi is reached. Default: 10,000
    verbose (bool): If True, it prints information while fitting. Default: False.
    ellipse_error (int, float): Model uncertainty to be considered in the fit, in km.
    sigma_result (int, float): Sigma value to be considered as result.

Returns:
    chisquare: A ChiSquare object with all parameters.

Examples:
    fit_ellipse(occ1, **kwargs) to fit the ellipse to the chords of occ1 Occultation object
    fit_ellipse(occ1, occ2, **kwargs) to fit the ellipse to the chords of occ1 and occ2 Occultation objects together
<span class="ansi-red-fg">File:</span>      ~/anaconda3/lib/python3.8/site-packages/sora/occultation/core.py
<span class="ansi-red-fg">Type:</span>      method

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ellipse_chi2</span>  <span class="o">=</span> <span class="n">occ</span><span class="o">.</span><span class="n">fit_ellipse</span><span class="p">(</span><span class="n">center_f</span><span class="o">=-</span><span class="mf">15.046</span><span class="p">,</span> <span class="n">center_g</span><span class="o">=-</span><span class="mf">2.495</span><span class="p">,</span> <span class="n">dcenter_f</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">dcenter_g</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                <span class="n">equatorial_radius</span><span class="o">=</span><span class="mi">138</span><span class="p">,</span> <span class="n">dequatorial_radius</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">oblateness</span><span class="o">=</span><span class="mf">0.093</span><span class="p">,</span>
                                <span class="n">doblateness</span><span class="o">=</span><span class="mf">0.20</span><span class="p">,</span> <span class="n">position_angle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">dposition_angle</span><span class="o">=</span><span class="mi">90</span> <span class="p">,</span><span class="n">loop</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span>
                                <span class="n">dchi_min</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">number_chi</span><span class="o">=</span><span class="mi">20000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Ellipse fit: |████████████████████████████████████████|  - 100%
</pre></div></div>
</div>
<p>Note that here we only used 100000 loops, but it is recommended at least 10 millions for a good sample for each parameter.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">ellipse_chi2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Minimum chi-square: 0.216
Number of fitted points: 10
Number of fitted parameters: 5
Minimum chi-square per degree of freedom: 0.043

center_f:
    1-sigma: -13.389 +/- 1.129
    3-sigma: -13.523 +/- 4.344

center_g:
    1-sigma: -2.526 +/- 4.686
    3-sigma: 0.331 +/- 17.107

equatorial_radius:
    1-sigma: 139.493 +/- 6.542
    3-sigma: 152.534 +/- 25.167

oblateness:
    1-sigma: 0.088 +/- 0.040
    3-sigma: 0.144 +/- 0.144

position_angle:
    1-sigma: 130.832 +/- 21.179
    3-sigma: 90.012 +/- 89.971

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ellipse_chi2</span><span class="o">.</span><span class="n">plot_chi2</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Tutorial_SORAv0.2_Occultation_56_0.png" src="../_images/examples_Tutorial_SORAv0.2_Occultation_56_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Tutorial_SORAv0.2_Occultation_56_1.png" src="../_images/examples_Tutorial_SORAv0.2_Occultation_56_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Tutorial_SORAv0.2_Occultation_56_2.png" src="../_images/examples_Tutorial_SORAv0.2_Occultation_56_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Tutorial_SORAv0.2_Occultation_56_3.png" src="../_images/examples_Tutorial_SORAv0.2_Occultation_56_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Tutorial_SORAv0.2_Occultation_56_4.png" src="../_images/examples_Tutorial_SORAv0.2_Occultation_56_4.png" />
</div>
</div>
<p><strong>Now, besides the chords we can plot the fitted ellipse</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sora.extra</span> <span class="kn">import</span> <span class="n">draw_ellipse</span>

<span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">()</span>
<span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1">#plotting the best fitted ellipse, in black</span>
<span class="n">draw_ellipse</span><span class="p">(</span><span class="o">**</span><span class="n">ellipse_chi2</span><span class="o">.</span><span class="n">get_values</span><span class="p">())</span>

<span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">+</span><span class="mi">170</span><span class="p">,</span><span class="o">-</span><span class="mi">330</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span><span class="o">+</span><span class="mi">250</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Tutorial_SORAv0.2_Occultation_58_0.png" src="../_images/examples_Tutorial_SORAv0.2_Occultation_58_0.png" />
</div>
</div>
<p><strong>Not just the fitted ellipse, but the user can also plot all the ellipses inside an sigma region, for instance within :math:`3sigma`</strong></p>
<p>This step will, possible, plot large number of ellipses, this can spend some CPU time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">()</span>
<span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1">#plotting the best fitted ellipse, in black</span>
<span class="n">draw_ellipse</span><span class="p">(</span><span class="o">**</span><span class="n">ellipse_chi2</span><span class="o">.</span><span class="n">get_values</span><span class="p">())</span>

<span class="c1"># ploting all the ellipses within 3-sigma, in gray</span>
<span class="n">draw_ellipse</span><span class="p">(</span><span class="o">**</span><span class="n">ellipse_chi2</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">+</span><span class="mi">170</span><span class="p">,</span><span class="o">-</span><span class="mi">330</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span><span class="o">+</span><span class="mi">250</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Tutorial_SORAv0.2_Occultation_60_0.png" src="../_images/examples_Tutorial_SORAv0.2_Occultation_60_0.png" />
</div>
</div>
<p><strong>As can be seen, there is some ellipses that cross the Hakos negative chord. They are impossibles solutions as the Hakos lightcurve show no evidence of an occultation. The User can filter this solutions using the</strong> <code class="docutils literal notranslate"><span class="pre">filter_negative_chord()</span></code> <strong>function.</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sora.occultation.utils</span> <span class="kn">import</span> <span class="n">filter_negative_chord</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>filter_negative_chord<span class="o">?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">Signature:</span> filter_negative_chord<span class="ansi-blue-fg">(</span>chord<span class="ansi-blue-fg">,</span> chisquare<span class="ansi-blue-fg">,</span> step<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> sigma<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>
Get points for the ellipse with the given input parameters

Parameters:
    chord (Chord): Chord object, must be associated to an Occultation to work.
    chisquare (ChiSquare): Resulted ChiSquare object of fit_ellipse.
    sigma (int, float): Unceartity of the expected ellipse, in km.
    step (number, &#39;exposure&#39;): If a number, it corresponds to the step, in seconds, for each point of the chord path.
        The step can also be equal to &#39;exposure&#39;. In this case, the chord path will consider the lightcurve individual
        times and exptime.
<span class="ansi-red-fg">File:</span>      ~/anaconda3/lib/python3.8/site-packages/sora/occultation/utils.py
<span class="ansi-red-fg">Type:</span>      function

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">filter_chi2</span> <span class="o">=</span> <span class="n">filter_negative_chord</span><span class="p">(</span><span class="n">chord</span> <span class="o">=</span> <span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="p">[</span><span class="s1">&#39;Hakos&#39;</span><span class="p">],</span> <span class="n">chisquare</span> <span class="o">=</span> <span class="n">ellipse_chi2</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">filter_chi2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Filter chord: Hakos |████████████████████████████████████████|  - 100%
Minimum chi-square: 0.216
Number of fitted points: 10
Number of fitted parameters: 5
Minimum chi-square per degree of freedom: 0.043

center_f:
    1-sigma: -13.389 +/- 1.129
    3-sigma: -13.523 +/- 4.344

center_g:
    1-sigma: -2.526 +/- 4.686
    3-sigma: 0.331 +/- 17.107

equatorial_radius:
    1-sigma: 139.493 +/- 6.542
    3-sigma: 148.183 +/- 20.816

oblateness:
    1-sigma: 0.088 +/- 0.040
    3-sigma: 0.130 +/- 0.130

position_angle:
    1-sigma: 130.832 +/- 21.179
    3-sigma: 90.012 +/- 89.971

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">()</span>
<span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1">#plotting the best fitted ellipse, in black</span>
<span class="n">draw_ellipse</span><span class="p">(</span><span class="o">**</span><span class="n">filter_chi2</span><span class="o">.</span><span class="n">get_values</span><span class="p">())</span>

<span class="c1"># ploting all the ellipses within 3-sigma, in gray</span>
<span class="n">draw_ellipse</span><span class="p">(</span><span class="o">**</span><span class="n">filter_chi2</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">+</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Tutorial_SORAv0.2_Occultation_65_0.png" src="../_images/examples_Tutorial_SORAv0.2_Occultation_65_0.png" />
</div>
</div>
<p><strong>The user can set</strong> <code class="docutils literal notranslate"><span class="pre">step</span> <span class="pre">=</span> <span class="pre">exposure</span></code> <strong>and consider only the region where data was acquired, allowing ellipses that crosses the negative chord during its readout time.</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">filter_2_chi2</span> <span class="o">=</span> <span class="n">filter_negative_chord</span><span class="p">(</span><span class="n">chord</span> <span class="o">=</span> <span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="p">[</span><span class="s1">&#39;Hakos&#39;</span><span class="p">],</span> <span class="n">chisquare</span> <span class="o">=</span> <span class="n">ellipse_chi2</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="s1">&#39;exposure&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">filter_2_chi2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Filter chord: Hakos |████████████████████████████████████████|  - 100%
Minimum chi-square: 0.216
Number of fitted points: 10
Number of fitted parameters: 5
Minimum chi-square per degree of freedom: 0.043

center_f:
    1-sigma: -13.389 +/- 1.129
    3-sigma: -13.523 +/- 4.344

center_g:
    1-sigma: -2.526 +/- 4.686
    3-sigma: 0.331 +/- 17.107

equatorial_radius:
    1-sigma: 139.493 +/- 6.542
    3-sigma: 149.696 +/- 22.328

oblateness:
    1-sigma: 0.088 +/- 0.040
    3-sigma: 0.131 +/- 0.131

position_angle:
    1-sigma: 130.832 +/- 21.179
    3-sigma: 90.012 +/- 89.971

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">occ</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">chord2</span><span class="o">.</span><span class="n">plot_chord</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;exposure&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hakos&#39;</span><span class="p">)</span>

<span class="c1">#plotting the best fitted ellipse, in black</span>
<span class="n">draw_ellipse</span><span class="p">(</span><span class="o">**</span><span class="n">filter_2_chi2</span><span class="o">.</span><span class="n">get_values</span><span class="p">())</span>

<span class="c1"># ploting all the ellipses within 3-sigma, in gray</span>
<span class="n">draw_ellipse</span><span class="p">(</span><span class="o">**</span><span class="n">filter_2_chi2</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">+</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Tutorial_SORAv0.2_Occultation_68_0.png" src="../_images/examples_Tutorial_SORAv0.2_Occultation_68_0.png" />
</div>
</div>
<p><strong>The radial velocity issue</strong></p>
<p>During the <code class="docutils literal notranslate"><span class="pre">LightCurve</span></code> fitting, the user has to add the velocity for that light curve. In the initial process, only the geocentric velocity was determined, and only after the fit, a radial velocity can be correctly calculated.</p>
<p>Usually, the light curves’ features are dominated by the exposure time. However, in the cases that the fresnel diffraction plays a significant role in it, we suggest that the <code class="docutils literal notranslate"><span class="pre">LightCurve</span></code> fitting procedure should be redone with the correct velocities.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">check_velocities</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Outeniqua - Velocity used: 22.004
    Immersion Radial Velocity: 18.810
    Emersion Radial Velocity: 19.229
Onduruquea - Velocity used: 22.004
    Immersion Radial Velocity: 22.271
    Emersion Radial Velocity: 22.273
Tivoli - Velocity used: 22.004
    Immersion Radial Velocity: 10.001
    Emersion Radial Velocity: 6.193
Windhoek C14 lc - Velocity used: 22.004
    Immersion Radial Velocity: 19.217
    Emersion Radial Velocity: 18.621
Windhoek D16 lc - Velocity used: 22.004
    Immersion Radial Velocity: 19.165
    Emersion Radial Velocity: 18.668
</pre></div></div>
</div>
</div>
<div class="section" id="4.-Viewing-and-saving-the-results">
<h2>4. Viewing and saving the results<a class="headerlink" href="#4.-Viewing-and-saving-the-results" title="Permalink to this headline">¶</a></h2>
<p>In the end, we can see the results using Python dictionaries. The <code class="docutils literal notranslate"><span class="pre">Occultation.fitted_params</span></code> will have fitted parameters and their <span class="math notranslate nohighlight">\(1\sigma\)</span> uncertainties. The <code class="docutils literal notranslate"><span class="pre">Occultation.chi2_params</span></code> will have some information about the fit and its quality.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">fitted_params</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;equatorial_radius&#39;: [139.49327194499352, 6.541765358897791],
 &#39;center_f&#39;: [-13.389359870265269, 1.1291045125581576],
 &#39;center_g&#39;: [-2.525501501624123, 4.685687336727549],
 &#39;oblateness&#39;: [0.08820233423598908, 0.039837635483676255],
 &#39;position_angle&#39;: [130.83208279183586, 21.179395044814527]}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chi2_params</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;chord_name&#39;: [&#39;Outeniqua_immersion&#39;,
  &#39;Outeniqua_emersion&#39;,
  &#39;Onduruquea_immersion&#39;,
  &#39;Onduruquea_emersion&#39;,
  &#39;Tivoli_immersion&#39;,
  &#39;Tivoli_emersion&#39;,
  &#39;Windhoek C14 lc_immersion&#39;,
  &#39;Windhoek C14 lc_emersion&#39;,
  &#39;Windhoek D16 lc_immersion&#39;,
  &#39;Windhoek D16 lc_emersion&#39;],
 &#39;radial_dispersion&#39;: array([ 0.32062784, -2.83531516, -1.70773305, -2.17197344, -0.33717119,
        -1.73307545, -1.54104696, -1.22694591, -2.61360828, -0.51106745]),
 &#39;position_angle&#39;: array([302.09409395,  58.69635038, 274.28405746,  84.51240035,
        205.96271873, 163.30859441, 238.65455402, 122.9796883 ,
        238.39395674, 122.76183443]),
 &#39;radial_error&#39;: array([ 7.15443575,  7.60165533,  2.23532231,  2.45888162, 15.65001123,
        15.65007535,  5.36529308,  5.81243008,  6.25950421,  7.60088696]),
 &#39;chi2_min&#39;: 0.2155283253699138,
 &#39;nparam&#39;: 5,
 &#39;npts&#39;: 10}
</pre></div></div>
</div>
<p><strong>The astrometrical positions obtained can be seen using</strong> <code class="docutils literal notranslate"><span class="pre">Occultation.new_astrometric_position()</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">new_astrometric_position</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Ephemeris offset (km): X = -13.4 km +/- 1.1 km; Y = -2.5 km +/- 4.7 km
Ephemeris offset (mas): da_cos_dec = -1.259 +/- 0.106; d_dec = -0.238 +/- 0.441

Astrometric object position at time 2017-06-22 21:18:48.200
RA = 18 55 15.6523928 +/- 0.113 mas; DEC = -31 31 21.622135 +/- 0.442 mas
</pre></div></div>
</div>
<p><strong>If the user wants the position at a specific time</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">new_astrometric_position</span><span class="p">(</span><span class="s1">&#39;2017-06-22 21:21:00.000&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Ephemeris offset (km): X = -13.4 km +/- 1.1 km; Y = -2.5 km +/- 4.7 km
Ephemeris offset (mas): da_cos_dec = -1.259 +/- 0.106; d_dec = -0.238 +/- 0.441

Astrometric object position at time 2017-06-22 21:21:00.000
RA = 18 55 15.6310599 +/- 0.113 mas; DEC = -31 31 21.623530 +/- 0.442 mas
</pre></div></div>
</div>
<p><strong>Also a ‘post-fit’ occultation map can be created using</strong> <code class="docutils literal notranslate"><span class="pre">Occultation.plot_occ_map()</span></code></p>
<p>The function that plots the map contains a large number of <em>kwargs</em>. They can be used to complete control the map and its tutorial can be found at SORA documentation here.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[83]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">centermap_delta</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3500</span><span class="p">,</span><span class="o">+</span><span class="mi">400</span><span class="p">],</span><span class="n">zoom</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">nameimg</span><span class="o">=</span><span class="s1">&#39;output/map_posfit&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Projected shadow radius = 134.3 km
output/map_posfit.png generated
</pre></div></div>
</div>
<p><img alt="6b7dc93f11984848a45c9c60f1672ce3" src="../_images/map_posfit1.png" /></p>
<p><strong>All this information can also be seen using</strong> <code class="docutils literal notranslate"><span class="pre">print(Occultation)</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[84]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">occ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Stellar occultation of star Gaia-DR2 6760223758801661440 by 10199 Chariklo (1997 CU26).

Geocentric Closest Approach: 0.049 arcsec
Instant of CA: 2017-06-22 21:18:48.200
Position Angle: 359.72 deg
Geocentric shadow velocity: -22.00 km / s
Sun-Geocenter-Target angle:  166.42 deg
Moon-Geocenter-Target angle: 149.11 deg


5 positive observations
1 negative observations

###############################################################################
                                     STAR
###############################################################################
Gaia-EDR3 star Source ID: 6760223758801661440
ICRS star coordinate at J2016.0:
RA=18h55m15.65210s +/- 0.0197 mas, DEC=-31d31m21.6676s +/- 0.0180 mas
pmRA=3.556 +/- 0.025 mas/yr, pmDEC=-2.050 +/- 0.020 mas/yr
Plx=0.2121 +/- 0.0228 mas, Rad. Vel.=0.00 +/- 0.00 km/s

Magnitudes: G: 14.224, B: 14.320, V: 13.530, R: 14.180, J: 12.395, H: 11.781,
            K: 11.627

Apparent diameter from Kervella et. al (2004):
    V: 0.0216 mas, B: 0.0216 mas
Apparent diameter from van Belle (1999):
    sg: B: 0.0238 mas, V: 0.0244 mas
    ms: B: 0.0261 mas, V: 0.0198 mas
    vs: B: 0.0350 mas, V: 0.0315 mas

Geocentric star coordinate at occultation Epoch (2017-06-22 21:18:48.200):
RA=18h55m15.65251s +/- 0.0395 mas, DEC=-31d31m21.6706s +/- 0.0300 mas

###############################################################################
                          10199 Chariklo (1997 CU26)
###############################################################################
Object Orbital Class: Centaur
Spectral Type:
    SMASS: D  [Reference: EAR-A-5-DDR-TAXONOMY-V4.0]
       Relatively featureless spectrum with very steep red slope.
Discovered 1997-Feb-15 by Spacewatch at Kitt Peak

Physical parameters:
Diameter:
    302 +/- 30 km
    Reference: Earth, Moon, and Planets, v. 89, Issue 1, p. 117-134 (2002),
Rotation:
    7.004 +/- 0 h
    Reference: LCDB (Rev. 2020-October); Warner et al., 2009, [Result based on less than full coverage, so that the period may be wrong by 30 percent or so.]  REFERENCE LIST:[Fornasier, S.; Lazzaro, D.; Alvarez-Candal, A.; Snodgrass, C.; et   al. (2014) Astron. Astrophys. 568, L11.], [Leiva, R.; Sicardy, B.; Camargo, J.I.B.; Desmars, J.; et al. (2017)   Astron. J. 154, A159.]
Absolute Magnitude:
    6.7 +/- 0 mag
    Reference: JPL Horizons,
Phase Slope:
    0.15 +/- 0
    Reference: JPL Horizons,
Albedo:
    0.045 +/- 0.01
    Reference: Earth, Moon, and Planets, v. 89, Issue 1, p. 117-134 (2002),

----------- Ephemeris -----------

EphemKernel: CHARIKLO/DE438_SMALL (SPKID=2010199)
Ephem Error: RA*cosDEC: 0.000 arcsec; DEC: 0.000 arcsec
Offset applied: RA*cosDEC: 0.0000 arcsec; DEC: 0.0000 arcsec


###############################################################################
                             POSITIVE OBSERVATIONS
###############################################################################

-------------------------------------------------------------------------------
Site: Outeniqua
Geodetic coordinates: Lon: 16d49m17.71s, Lat: -21d17m58.17s, height: 1.416 km
Target altitude: 56.6 deg
Target azimuth:  115.3 deg

Light curve name: Outeniqua lc
Initial time: 2017-06-22 21:20:00.056 UTC
End time:     2017-06-22 21:29:59.963 UTC
Duration:     9.998 minutes
Time offset:  -0.150 seconds

Object LightCurve was not instantiated with time and flux.

Bandpass:             0.700 +/- 0.300 microns
Object Distance:      14.66 AU
Used shadow velocity: 22.004 km/s
Fresnel scale:        0.040 seconds or 0.87 km
Stellar size effect:  0.010 seconds or 0.23 km

Object LightCurve model was not fitted.

Immersion time: 2017-06-22 21:21:20.179 UTC +/- 0.320 seconds
Emersion time:  2017-06-22 21:21:30.193 UTC +/- 0.340 seconds


-------------------------------------------------------------------------------
Site: Onduruquea
Geodetic coordinates: Lon: 15d59m33.75s, Lat: -21d36m26.04s, height: 1.220 km
Target altitude: 56.1 deg
Target azimuth:  114.7 deg

Light curve name: Onduruquea lc
Initial time: 2017-06-22 21:11:52.175 UTC
End time:     2017-06-22 21:25:13.389 UTC
Duration:     13.354 minutes
Time offset:  -0.190 seconds

Object LightCurve was not instantiated with time and flux.

Bandpass:             0.700 +/- 0.300 microns
Object Distance:      14.66 AU
Used shadow velocity: 22.004 km/s
Fresnel scale:        0.040 seconds or 0.87 km
Stellar size effect:  0.010 seconds or 0.23 km

Object LightCurve model was not fitted.

Immersion time: 2017-06-22 21:21:22.023 UTC +/- 0.100 seconds
Emersion time:  2017-06-22 21:21:33.634 UTC +/- 0.110 seconds


-------------------------------------------------------------------------------
Site: Tivoli
Geodetic coordinates: Lon: 18d01m01.24s, Lat: -23d27m40.19s, height: 1.344 km
Target altitude: 58.5 deg
Target azimuth:  112.4 deg

Light curve name: Tivoli lc
Initial time: 2017-06-22 21:16:00.094 UTC
End time:     2017-06-22 21:28:00.018 UTC
Duration:     11.999 minutes
Time offset:  -0.150 seconds

Object LightCurve was not instantiated with time and flux.

Bandpass:             0.700 +/- 0.300 microns
Object Distance:      14.66 AU
Used shadow velocity: 22.004 km/s
Fresnel scale:        0.040 seconds or 0.87 km
Stellar size effect:  0.010 seconds or 0.23 km

Object LightCurve model was not fitted.

Immersion time: 2017-06-22 21:21:15.478 UTC +/- 0.700 seconds
Emersion time:  2017-06-22 21:21:19.838 UTC +/- 0.700 seconds


-------------------------------------------------------------------------------
Site: Windhoek
Geodetic coordinates: Lon: 17d06m31.9s, Lat: -22d41m55.16s, height: 1.902 km
Target altitude: 57.4 deg
Target azimuth:  113.4 deg

Light curve name: Windhoek C14 lc
Initial time: 2017-06-22 21:12:48.250 UTC
End time:     2017-06-22 21:32:47.963 UTC
Duration:     19.995 minutes
Time offset:  -0.375 seconds

Object LightCurve was not instantiated with time and flux.

Bandpass:             0.700 +/- 0.300 microns
Object Distance:      14.66 AU
Used shadow velocity: 22.004 km/s
Fresnel scale:        0.040 seconds or 0.87 km
Stellar size effect:  0.010 seconds or 0.23 km

Object LightCurve model was not fitted.

Immersion time: 2017-06-22 21:21:17.234 UTC +/- 0.240 seconds
Emersion time:  2017-06-22 21:21:27.189 UTC +/- 0.260 seconds


-------------------------------------------------------------------------------
Site: Windhoek
Geodetic coordinates: Lon: 17d06m31.9s, Lat: -22d41m55.16s, height: 1.902 km
Target altitude: 57.4 deg
Target azimuth:  113.4 deg

Light curve name: Windhoek D16 lc
Initial time: 2017-06-22 21:20:01.884 UTC
End time:     2017-06-22 21:22:21.894 UTC
Duration:     2.333 minutes
Time offset:  0.000 seconds

Object LightCurve was not instantiated with time and flux.

Bandpass:             0.700 +/- 0.300 microns
Object Distance:      14.66 AU
Used shadow velocity: 22.004 km/s
Fresnel scale:        0.040 seconds or 0.87 km
Stellar size effect:  0.010 seconds or 0.23 km

Object LightCurve model was not fitted.

Immersion time: 2017-06-22 21:21:17.288 UTC +/- 0.280 seconds
Emersion time:  2017-06-22 21:21:27.228 UTC +/- 0.340 seconds


###############################################################################
                             NEGATIVE OBSERVATIONS
###############################################################################

-------------------------------------------------------------------------------
Site: Hakos
Geodetic coordinates: Lon: 16d21m41.32s, Lat: -23d14m11.04s, height: 1.843 km
Target altitude: 56.8 deg
Target azimuth:  112.5 deg

Light curve name: Hakos lc
Initial time: 2017-06-22 21:10:19.961 UTC
End time:     2017-06-22 21:30:16.955 UTC
Duration:     19.950 minutes
Time offset:  0.000 seconds

Exposure time:    1.0000 seconds
Cycle time:       2.9998 seconds
Num. data points: 400

Bandpass:             0.700 +/- 0.300 microns
Object Distance:      14.66 AU
Used shadow velocity: 22.004 km/s
Fresnel scale:        0.040 seconds or 0.87 km
Stellar size effect:  0.010 seconds or 0.23 km

Object LightCurve model was not fitted.

Immersion and emersion times were not fitted or instantiated.


###############################################################################
                                    RESULTS
###############################################################################

Fitted Ellipse:
equatorial_radius: 139.493 +/- 6.542
center_f: -13.389 +/- 1.129
center_g: -2.526 +/- 4.686
oblateness: 0.088 +/- 0.040
position_angle: 130.832 +/- 21.179
polar_radius: 127.190 km
equivalent_radius: 133.199 km
geometric albedo (V): 0.053 (5.3%)

Minimum chi-square: 0.216
Number of fitted points: 10
Number of fitted parameters: 5
Minimum chi-square per degree of freedom: 0.043
Radial dispersion: -1.436 +/- 1.014 km
Radial error:      7.579 +/- 4.655 km

Ephemeris offset (km): X = -13.4 km +/- 1.1 km; Y = -2.5 km +/- 4.7 km
Ephemeris offset (mas): da_cos_dec = -1.259 +/- 0.106; d_dec = -0.238 +/- 0.441

Astrometric object position at time 2017-06-22 21:18:48.200
RA = 18 55 15.6523928 +/- 0.113 mas; DEC = -31 31 21.622135 +/- 0.442 mas
</pre></div></div>
</div>
<p><strong>And this can be saved to an ASCII file using</strong> <code class="docutils literal notranslate"><span class="pre">Occultation.to_log</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">to_log</span><span class="p">(</span><span class="s1">&#39;output/Test_occ.log&#39;</span><span class="p">)</span>

<span class="o">!</span>ls output/*.log
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
output/Test_occ.log
</pre></div></div>
</div>
<p><strong>This Jupyter-Notebook was designed as a tutorial for how to work with the</strong> <code class="docutils literal notranslate"><span class="pre">Occultation</span></code> <strong>Object Class. More information about the other classes, please refer to their specif Jupyter-Notebook. Any further question, please contact the core team: Altair Ramos Gomes Júnior, Bruno Eduardo Morgado, Gustavo Benedetti Rossi, and Rodrigo Carlos Boufleur.</strong></p>
<p><strong>The End</strong></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Tutorial_SORAv0.2_ChiSquare.html" class="btn btn-neutral float-right" title="ChiSquare Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Tutorial_SORAv0.2_LightCurve.html" class="btn btn-neutral float-left" title="LightCurve Class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, SORA Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>